<!doctype html>
<html>
  <head>
    <title>Test Vercel API</title>
  </head>
  <body>
    <h1>Vercel API Test</h1>
    <button onclick="testAPI()">Test API Connection</button>
    <div id="results"></div>

    <script>
      async function testAPI() {
        const results = document.getElementById("results");
        results.innerHTML = "<p>Testing...</p>";

        try {
          console.log("Testing Vercel API connection...");

          // Test the simple endpoint first
          const response = await fetch(
            "https://rudegyaljm-amber.vercel.app/api/test-simple",
            {
              method: "GET",
              mode: "cors",
            },
          );

          console.log("Response status:", response.status);
          console.log("Response headers:", response.headers);

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const data = await response.json();
          console.log("Response data:", data);

          results.innerHTML = `
                    <h2>✅ API Test Successful</h2>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;

          // Now test the seed endpoint
          testSeedEndpoint();
        } catch (error) {
          console.error("API test failed:", error);
          results.innerHTML = `
                    <h2>❌ API Test Failed</h2>
                    <p>Error: ${error.message}</p>
                `;
        }
      }

      async function testSeedEndpoint() {
        try {
          console.log("Testing seed endpoint...");

          const response = await fetch(
            "https://rudegyaljm-amber.vercel.app/api/seed-database",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              mode: "cors",
            },
          );

          console.log("Seed response status:", response.status);

          const data = await response.json();
          console.log("Seed response data:", data);

          const seedResults = document.createElement("div");
          seedResults.innerHTML = `
                    <h2>Seed Endpoint Test</h2>
                    <p>Status: ${response.status}</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
          document.getElementById("results").appendChild(seedResults);
        } catch (error) {
          console.error("Seed test failed:", error);
          const seedResults = document.createElement("div");
          seedResults.innerHTML = `
                    <h2>❌ Seed Test Failed</h2>
                    <p>Error: ${error.message}</p>
                `;
          document.getElementById("results").appendChild(seedResults);
        }
      }
    </script>
  </body>
</html>
